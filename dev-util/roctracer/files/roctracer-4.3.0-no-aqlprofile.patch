Index: roctracer-rocm-5.1.3/src/util/hsa_rsrc_factory.cpp
===================================================================
--- roctracer-rocm-5.1.3.orig/src/util/hsa_rsrc_factory.cpp
+++ roctracer-rocm-5.1.3/src/util/hsa_rsrc_factory.cpp
@@ -131,10 +131,8 @@ HsaRsrcFactory::HsaRsrcFactory(bool init
   aqlprofile_api_ = {0};
 #ifdef ROCP_LD_AQLPROFILE
   status = LoadAqlProfileLib(&aqlprofile_api_);
-#else
-  status = hsa_api_.hsa_system_get_major_extension_table(HSA_EXTENSION_AMD_AQLPROFILE, hsa_ven_amd_aqlprofile_VERSION_MAJOR, sizeof(aqlprofile_api_), &aqlprofile_api_);
-#endif
   CHECK_STATUS("aqlprofile API table load failed", status);
+#endif
 
   // Get Loader API table
   loader_api_ = {0};
Index: roctracer-rocm-5.1.3/test/hsa/src/hsa_rsrc_factory.cpp
===================================================================
--- roctracer-rocm-5.1.3.orig/test/hsa/src/hsa_rsrc_factory.cpp
+++ roctracer-rocm-5.1.3/test/hsa/src/hsa_rsrc_factory.cpp
@@ -129,10 +129,8 @@ HsaRsrcFactory::HsaRsrcFactory(bool init
   aqlprofile_api_ = {0};
 #ifdef ROCP_LD_AQLPROFILE
   status = LoadAqlProfileLib(&aqlprofile_api_);
-#else
-  status = hsa_api_.hsa_system_get_major_extension_table(HSA_EXTENSION_AMD_AQLPROFILE, hsa_ven_amd_aqlprofile_VERSION_MAJOR, sizeof(aqlprofile_api_), &aqlprofile_api_);
-#endif
   CHECK_STATUS("aqlprofile API table load failed", status);
+#endif
 
   // Get Loader API table
   loader_api_ = {0};
