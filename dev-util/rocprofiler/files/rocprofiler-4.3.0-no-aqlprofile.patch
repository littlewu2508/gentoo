Skip loading proprietary AQLProfile lib
Index: rocprofiler-rocm-5.1.3/src/util/hsa_rsrc_factory.cpp
===================================================================
--- rocprofiler-rocm-5.1.3.orig/src/util/hsa_rsrc_factory.cpp
+++ rocprofiler-rocm-5.1.3/src/util/hsa_rsrc_factory.cpp
@@ -142,10 +142,8 @@ HsaRsrcFactory::HsaRsrcFactory(bool init
   aqlprofile_api_ = {0};
 #ifdef ROCP_LD_AQLPROFILE
   status = LoadAqlProfileLib(&aqlprofile_api_);
-#else
-  status = hsa_api_.hsa_system_get_major_extension_table(HSA_EXTENSION_AMD_AQLPROFILE, hsa_ven_amd_aqlprofile_VERSION_MAJOR, sizeof(aqlprofile_api_), &aqlprofile_api_);
-#endif
   CHECK_STATUS("aqlprofile API table load failed", status);
+#endif
 
   // Get Loader API table
   loader_api_ = {0};
Index: rocprofiler-rocm-5.1.3/test/util/hsa_rsrc_factory.cpp
===================================================================
--- rocprofiler-rocm-5.1.3.orig/test/util/hsa_rsrc_factory.cpp
+++ rocprofiler-rocm-5.1.3/test/util/hsa_rsrc_factory.cpp
@@ -139,10 +139,8 @@ HsaRsrcFactory::HsaRsrcFactory(bool init
   aqlprofile_api_ = {0};
 #ifdef ROCP_LD_AQLPROFILE
   status = LoadAqlProfileLib(&aqlprofile_api_);
-#else
-  status = hsa_api_.hsa_system_get_major_extension_table(HSA_EXTENSION_AMD_AQLPROFILE, hsa_ven_amd_aqlprofile_VERSION_MAJOR, sizeof(aqlprofile_api_), &aqlprofile_api_);
-#endif
   CHECK_STATUS("aqlprofile API table load failed", status);
+#endif
 
   // Get Loader API table
   loader_api_ = {0};
